@prefix rr: <http://www.w3.org/ns/r2rml#>.
@prefix ecommerce: <http://data.ecommerce#>.

#Supplier Mapping
<#Supplier>
  a rr:TriplesMap ;
  rr:logicalTable [rr:tableName "ecommerce.sv_supplier"];
  rr:subjectMap[
    rr:template "http://data.ecommerce/Supplier#{companyname}";
    rr:class ecommerce:supplier;
  ];
  rr:predicateObjectMap[
    rr:predicate ecommerce:Supplierbce;
    rr:objectMap[
      rr:column "bce"
    ]
  ];
  rr:predicateObjectMap[
    rr:predicate ecommerce:Supplier_companyName;
    rr:objectMap[
      rr:column "companyname"
    ]
  ];
  rr:predicateObjectMap[
    rr:predicate ecommerce:Supplier_postalCode;
    rr:objectMap[
      rr:column "postalcode"
    ]
  ];
  rr:predicateObjectMap[
    rr:predicate ecommerce:Supplier_ph;
    rr:objectMap[
      rr:column "telephone"
    ]
  ];
  rr:predicateObjectMap[
    rr:predicate ecommerce:Supplier_country;
    rr:objectMap[
      rr:column "addresscountry"
    ]
  ];
  rr:predicateObjectMap[
    rr:predicate ecommerce:Supplier_streetAddress;
    rr:objectMap[
      rr:column "streetaddress"
    ]
  ];
  rr:predicateObjectMap[
    rr:predicate ecommerce:supplier_addressLocaity;
    rr:objectMap[
      rr:column "addresslocality"
    ]
  ];
  rr:predicateObjectMap[
    rr:predicate ecommerce:Supplier_city;
    rr:objectMap[
      rr:column "addresscity"
    ]
  ];
  rr:predicateObjectMap[
    rr:predicate ecommerce:Supplier_email;
    rr:objectMap[
      rr:column "email"
    ]
  ].
  <#Supplies>
  a rr:TriplesMap ;
  rr:logicalTable [rr:tableName "ecommerce.sv_supplies"];
  rr:subjectMap[
    rr:template "http://data.ecommerce/Supplies#{suppliesid}";
    rr:class ecommerce:Supplies;
  ];
  rr:predicateObjectMap[
    rr:predicate ecommerce:suppliesID;
    rr:objectMap[
      rr:column "suppliesid"
    ]
  ];
  rr:predicateObjectMap[
    rr:predicate ecommerce:arrivalDate;
    rr:objectMap[
      rr:column "arrivaldate"
    ]
  ];
  rr:predicateObjectMap[
    rr:predicate ecommerce:supplyState;
    rr:objectMap[
      rr:column "supplystate"
    ]
  ].
  <#SuppliesStock>
  a rr:TriplesMap ;
  rr:logicalTable [rr:tableName "ecommerce.sv_suppliesstock"];
  rr:subjectMap[
    rr:template "http://data.ecommerce/SuppliesStock#{supply}";
    rr:class ecommerce:SuppliesStock;
  ];
  rr:predicateObjectMap[
    rr:predicate ecommerce:suppliesStockSku;
    rr:objectMap[
      rr:column "supply"
    ]
  ];
  rr:predicateObjectMap[
    rr:predicate ecommerce:suppliesOrderPrice;
    rr:objectMap[
      rr:column "price"
    ]
  ];
  rr:predicateObjectMap[
    rr:predicate ecommerce:suppliesOrderQuantity;
    rr:objectMap[
      rr:column "quantity"
    ]
  ].
  
  # adding products for supplyStock class 
<#ProductsSupplies>
  a rr:TriplesMap ;
  rr:logicalTable [rr:tableName "ecommerce.sv_product"];
  rr:subjectMap[
    rr:template "http://data.ecommerce/Product#{sku}";
    rr:class ecommerce:Product;
  ];
  rr:predicateObjectMap[
    rr:predicate ecommerce:sku;
    rr:objectMap[
      rr:column "sku"
    ]
  ];
  rr:predicateObjectMap[
    rr:predicate ecommerce:brand;
    rr:objectMap[
      rr:column "brand"
    ]
  ];
  rr:predicateObjectMap[
    rr:predicate ecommerce:category;
    rr:objectMap[
      rr:column "category"
    ]
  ];
  rr:predicateObjectMap[
    rr:predicate ecommerce:color;
    rr:objectMap[
      rr:column "color"
    ]
  ];
  rr:predicateObjectMap[
    rr:predicate ecommerce:Item_condition;
    rr:objectMap[
      rr:column "itemcondition"
    ]
  ];
  rr:predicateObjectMap[
    rr:predicate ecommerce:model;
    rr:objectMap[
      rr:column "model"
    ]
  ];
  rr:predicateObjectMap[
    rr:predicate ecommerce:Product_date_added;
    rr:objectMap[
      rr:column "date_added"
    ]
  ];
  rr:predicateObjectMap[
    rr:predicate ecommerce:Product_description;
    rr:objectMap[
      rr:column "description"
    ]
  ];
  rr:predicateObjectMap[
    rr:predicate ecommerce:price;
    rr:objectMap[
      rr:column "price"
    ]
  ];
  rr:predicateObjectMap[
    rr:predicate ecommerce:stockQuantity;
    rr:objectMap[
      rr:column "stockquantity"
    ]
  ].
  
  # adding warehouse for supplies class 
  <#warehouse>
  a rr:TriplesMap;
  rr:logicalTable [
    rr:tableName "ecommerce.sv_warehouse"
  ];
  rr:subjectMap [
    rr:template "http://data.ecommerce/Warehouse#{warehousecode}";
    rr:class ecommerce:Warehouse;
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:warehousecode;
    rr:objectMap [rr:column "warehousecode"]
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:companyname;
    rr:objectMap [rr:column "companyname"]
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:email;
    rr:objectMap [rr:column "email"]
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:telephone;
    rr:objectMap [rr:column "telephone"]
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:addresscountry;
    rr:objectMap [rr:column "addresscountry"]
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:addresscity;
    rr:objectMap [rr:column "addresscity"]
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:addresslocality;
    rr:objectMap [rr:column "addresslocality"]
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:postalcode;
    rr:objectMap [rr:column "postalcode"]
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:streetaddress;
    rr:objectMap [rr:column "streetaddress"]
  ].
  <#SuppliesProperty>
  a rr:TriplesMap ;
  rr:logicalTable [rr:sqlQuery """SELECT B.csuppliername As csuppliername, A.norderuuid AS norderuuid FROM ecommerce.spurchase_order A
                                  INNER JOIN ecommerce.ssupplier B ON B.csupplierbce=A.csupplierbce""";
                   rr:sqlVersion rr:SQL2008;
  ];
  rr:subjectMap[
    rr:template "http://data.ecommerce/supplier#{csuppliername}";
    rr:class ecommerce:supplier;
  ];
  rr:predicateObjectMap[
    rr:predicate ecommerce:supplies;
    rr:objectMap[
      rr:template "http://data.ecommerce/Supplies#{norderuuid}";
    ]
  ].
  <#Supplies_has>
  a rr:TriplesMap ;  
  rr:logicalTable [rr:sqlQuery """SELECT A.norderuuid, B.norderdetailuuid FROM ecommerce.spurchase_order A
                                  INNER JOIN ecommerce.spurchase_order_detail B ON B.norderuuid=A.norderuuid""";
                                  rr:sqlVersion rr:SQL2008;
  ];
  rr:subjectMap[
    rr:template "http://data.ecommerce/Supplies/{norderuuid}";
    rr:class ecommerce:Supplies;
  ];
  rr:predicateObjectMap[
    rr:predicate ecommerce:supplies_has;
    rr:objectMap[
      rr:template "http://data.ecommerce/SuppliesStock/{norderdetailuuid}";
    ]
  ].
  <#is_delivered_to>
  rr:logicalTable [rr:sqlQuery """SELECT A.norderuuid, B.bce AS warehousecode FROM ecommerce.spurchase_order A
                                  INNER JOIN ecommerce.swarehouse B ON B.bce=A.warehousecode""";
                                  rr:sqlVersion rr:SQL2008;
  ];
  rr:subjectMap[
    rr:template "http://data.ecommerce/Supplies/{norderuuid}";
    rr:class ecommerce:Supplies;
  ];
  rr:predicateObjectMap[
    rr:predicate ecommerce:is_delivered_to;
    rr:objectMap[
      rr:template "http://data.ecommerce/Warehouse/{warehousecode}";
    ]
  ].
  
#Warehouse Mapping
<#Warehouse02>
  a rr:TriplesMap ;
  rr:logicalTable [rr:tableName "ecommerce.wwarehouse"];
  rr:subjectMap[
    rr:template "http://data.ecommerce/Warehouse#{warehousecode}";
    rr:class ecommerce:Warehouse;
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:warehous_code;
    rr:objectMap [rr:column "warehousecode"]
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:Warehouse_companyName;
    rr:objectMap [rr:column "companyname"]
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:Warehouse_email;
    rr:objectMap [rr:column "email"]
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:telephone;
    rr:objectMap [rr:column "telephone"]
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:Warehouse_country;
    rr:objectMap [rr:column "addresscountry"]
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:Warehouse_city;
    rr:objectMap [rr:column "addresscity"]
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:warehouse_addresslocaity;
    rr:objectMap [rr:column "addresslocality"]
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:Warehouse_postalCode;
    rr:objectMap [rr:column "postalcode"]
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:Warehouse_streetAddress;
    rr:objectMap [rr:column "streetAddress"]
  ].
  
#Inventory mapping
<#Inventory>
  a rr:TriplesMap;
  
  rr:logicalTable [rr:sqlQuery """SELECT productsku_fk, warehousecode_fk, quantity FROM ecommerce.winventory""";
                                  rr:sqlVersion rr:SQL2008;
  ];
  rr:subjectMap [
    rr:template "http://data.ecommerce/Inventory#{productsku_fk}_{warehousecode_fk}";
    rr:class ecommerce:Inventory;
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:warehous_code;
    rr:objectMap [rr:column "warehousecode_fk"]
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:InventoryQuantity;
    rr:objectMap [rr:column "quantity"]
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:productsku_fk;
    rr:objectMap [rr:column "productsku_fk"]
  ]. 
   
#warehouse_has mapping
<#warehouse_has>
  a rr:TriplesMap;
  
  rr:logicalTable [
  rr:sqlQuery """SELECT A.warehousecode AS warehousecode,
                  B.warehousecode_fk,
                  B.productsku_fk
                  FROM ecommerce.wwarehouse A INNER JOIN ecommerce.winventory B ON warehousecode=B.warehousecode_fk""";
                  rr:sqlVersion rr:SQL2008;
  ];
  rr:subjectMap [
    rr:template "http://data.ecommerce/Warehouse#{warehousecode}";
    rr:class ecommerce:Warehouse;
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:warehouse_has;
    rr:objectMap [
      rr:template "http://data.ecommerce/Inventory#{productsku_fk}_{warehousecode_fk}";
    ];
  ].

# TransportCompany Mapping
<#transportcompany>
  a rr:TriplesMap ;
  
  rr:logicalTable [
  rr:sqlQuery """SELECT name, price_per_km, api_key
                  FROM ecommerce.dtransportcompany""";
                  rr:sqlVersion rr:SQL2008;
  ];
  rr:subjectMap [
    rr:template "http://data.ecommerce/TransportCompany#{name}";
    rr:class ecommerce:TransportCompany;
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:TransportCompanyname ;
    rr:objectMap [rr:column "name"];
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:price_per_km ;
    rr:objectMap [rr:column "price_per_km"];
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:api_key ;
    rr:objectMap [rr:column "api_key"];
  ].

# deliverytrip Mapping
<#transportvehicle>
  a rr:TriplesMap ;
  rr:logicalTable [
    rr:tableName "ecommerce.dtransportvehicle"
  ];
  rr:subjectMap [
    rr:template "http://data.ecommerce/Transportvehicle#{id}";
    rr:class ecommerce:TransportVehicle;
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:TransportVehicleID ;
    rr:objectMap [rr:column "id"];
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:position ;
    rr:objectMap [rr:column "position"];
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:TransportCompany;
    rr:objectMap [
      rr:parentTriplesMap <#transportcompany> ;
      rr:joinCondition [
        rr:child "company" ;
        rr:parent "name"
      ]
    ]
  ].
  #Warehouse mapping
<#Warehouse03>
  a rr:TriplesMap;
  rr:logicalTable [
    rr:tableName "ecommerce.dwarehouse"
  ];
  rr:subjectMap [
    rr:template "http://data.ecommerce/Warehouse#{warehousecode}";
    rr:class ecommerce:Warehouse;
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:warehous_code;
    rr:objectMap [rr:column "warehousecode"]
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:Warehouse_companyName;
    rr:objectMap [rr:column "companyname"]
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:Warehouse_email;
    rr:objectMap [rr:column "email"]
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:telephone;
    rr:objectMap [rr:column "telephone"]
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:Warehouse_country;
    rr:objectMap [rr:column "addresscountry"]
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:Warehouse_city;
    rr:objectMap [rr:column "addresscity"]
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:warehouse_addresslocaity;
    rr:objectMap [rr:column "addresslocality"]
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:Warehouse_postalCode;
    rr:objectMap [rr:column "postalcode"]
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:Warehouse_streetAddress;
    rr:objectMap [rr:column "streetaddress"]
  ].
  
  # deliverytrip Mapping
<#deliverytrip>
  a rr:TriplesMap ;
  rr:logicalTable [
    rr:tableName "ecommerce.ddeliverytrip"
  ];
  rr:subjectMap [
    rr:template "http://data.ecommerce/Deliverytrip#{id}";
    rr:class ecommerce:DeliveryTrip;
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:DeliveryTrip_ID ;
    rr:objectMap [rr:column "id"];
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:departure_time ;
    rr:objectMap [rr:column "departure_time"];
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:arrival_time ;
    rr:objectMap [rr:column "arrival_time"];
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:TransportVehicle ;
    rr:objectMap [
      rr:parentTriplesMap <#transportvehicle> ;
      rr:joinCondition [
        rr:child "truck";
        rr:parent "id"
      ]
    ]
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:Warehouse ;
    rr:objectMap [
      rr:parentTriplesMap <#Warehouse03>;
      rr:joinCondition [
        rr:child "starting_warehouse";
        rr:parent "warehousecode"
      ]
    ]
  ].

# customers_information Mapping
<#customers_information>
  a rr:TriplesMap ;
  rr:logicalTable [
    rr:tableName "ecommerce.ccustomers_information"
  ];
  rr:subjectMap [
    rr:template "http://data.ecommerce/customers_information#{email}";
    rr:class ecommerce:Customer;
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:first_name ;
    rr:objectMap [rr:column "first_name"];
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:last_name ;
    rr:objectMap [rr:column "last_name"];
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:birth_date ;
    rr:objectMap [rr:column "birth_date"];
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:phone_number ;
    rr:objectMap [rr:column "phone_number"];
  ].
  #
  #rr:predicateObjectMap [
  #  rr:predicate ecommerce:Delivery_Type ;
  #  rr:objectMap [
  #    rr:parentTriplesMap <#delivery_services_type> ;
  #    rr:joinCondition [
  #    rr:child "delivery_kind" ;
  #    rr:parent "delivery_kind"
  #    ]
  #  ]
  #].
  
  # delivery_services_type Mapping
  <#delivery_services_type>
  a rr:TriplesMap ;
  rr:logicalTable [
    rr:tableName "ecommerce.cdelivery_services_type"
  ];
  rr:subjectMap [
    rr:template "http://data.ecommerce/delivery_services_type#{delivery_kind}";
    rr:class ecommerce:Delivery_Type;
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:Delivery_Type ;
    rr:objectMap [rr:column "delivery_kind"];
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:price ;
    rr:objectMap [rr:column "price"];
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:delivery_duration ;
    rr:objectMap [rr:column "delivery_duration"];
  ].
  
  # PaymentCard Mapping
  <#paymentcard>
  a rr:TriplesMap ;
  rr:logicalTable [
    rr:tableName "ecommerce.cpaymentcard"
  ];
  rr:subjectMap [
    rr:template "http://data.ecommerce/PaymentCard#{cardType}_{cardNumber}";
    rr:class ecommerce:Payment_Card;
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:cardHolderName ;
    rr:objectMap [rr:column "cardHolderName"];
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:cardExpiryDate ;
    rr:objectMap [rr:column "cardExpiryDate"];
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:Customer_email ;
    rr:objectMap [
      rr:parentTriplesMap <#customers_information> ;
      rr:joinCondition [
      rr:child "customerEmail" ;
      rr:parent "email"
      ]
    ]
  ].
  
# customers_addresses Mapping
<#customers_addresses>
  a rr:TriplesMap ;
  rr:logicalTable [
    rr:tableName "ecommerce.ccustomers_addresses"
  ];
  rr:subjectMap [
    rr:template "http://data.ecommerce/customers_addresses#{email}_{country}_{city}_{address}";
    rr:class ecommerce:Address;
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:Customer_email ;
    rr:objectMap [
      rr:parentTriplesMap <#customers_information> ;
      rr:joinCondition [
      rr:child "email" ;
      rr:parent "email"
      ]
    ]
  ].

# delivery_status_description Mapping
<#delivery_status_description>
  a rr:TriplesMap ;
  rr:logicalTable [
    rr:tableName "ecommerce.cdelivery_status_description"
  ];
  rr:subjectMap [
    rr:template "http://data.ecommerce/delivery_status_description#{delivery_status}";
    rr:class ecommerce:Delivery_status;
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:description ;
    rr:objectMap [rr:column "decription"];
  ].

# receipt_information Mapping
<#receipt_information>
  a rr:TriplesMap ;
  rr:logicalTable [
    rr:tableName "ecommerce.creceipt_information"
  ];
  rr:subjectMap [
    rr:template "http://data.ecommerce/receipt_information#{receipt_id}";
    rr:class ecommerce:Order;
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:date ;
    rr:objectMap [rr:column "date"];
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:orderAmount ;
    rr:objectMap [rr:column "orderamount"];
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:full_address ;
    rr:objectMap [rr:column "address"];
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:Customer_email ;
    rr:objectMap [
      rr:parentTriplesMap <#customers_information> ;
      rr:joinCondition [
      rr:child "email" ;
      rr:parent "email"
      ]
    ]
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:Delivery_status ;
    rr:objectMap [
      rr:parentTriplesMap <#delivery_status_description> ;
      rr:joinCondition [
      rr:child "delivery_status" ;
      rr:parent "delivery_status"
      ]
    ]
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:Delivery_Type ;
    rr:objectMap [
      rr:parentTriplesMap <#delivery_services_type> ;
      rr:joinCondition [
      rr:child "delivery_type" ;
      rr:parent "delivery_kind"
      ]
    ]
  ].
  
 # customer_receipt_connector Mapping
<#customer_receipt_connector>
  a rr:TriplesMap ;
  rr:logicalTable [
    rr:tableName "ecommerce.ccustomer_receipt_connector"
  ];
  rr:subjectMap [
    rr:template "http://data.ecommerce/customer_receipt_connector#{email}_{receipt_id}";
    rr:class ecommerce:Customer;
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:Customer_email ;
    rr:objectMap [
      rr:parentTriplesMap <#customers_information> ;
      rr:joinCondition [
      rr:child "email" ;
      rr:parent "email"
      ]
    ]
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:Order ;
    rr:objectMap [
      rr:parentTriplesMap <#receipt_information> ;
      rr:joinCondition [
      rr:child "receipt_id" ;
      rr:parent "receipt_id"
      ]
    ]
  ].

# product Mapping
<#product02>
  a rr:TriplesMap ;
  rr:logicalTable [
    rr:tableName "ecommerce.cproduct"
  ];
  rr:subjectMap [
    rr:template "http://data.ecommerce/Product#{sku}";
    rr:class ecommerce:Product;
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:Product_description ;
    rr:objectMap [rr:column "name"];
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:color ;
    rr:objectMap [rr:column "color"];
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:Item_condition ;
    rr:objectMap [rr:column "itemcondition"];
  ];
  #rr:predicateObjectMap [
  #  rr:predicate ecommerce:Product_description ;
  #  rr:objectMap [rr:column "description"];
  #];
  rr:predicateObjectMap [
    rr:predicate ecommerce:stockQuantity ;
    rr:objectMap [rr:column "stockquantity"];
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:location ;
    rr:objectMap [rr:column "location"];
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:Product_date_added ;
    rr:objectMap [rr:column "dateadded"];
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:brand ;
    rr:objectMap [rr:column "brand"];
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:category ;
    rr:objectMap [rr:column "category"];
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:Product_price ;
    rr:objectMap [rr:column "category"];
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:model ;
    rr:objectMap [rr:column "model"];
  ].
  
 # goods_in_receipt Mapping
<#goods_in_receipt>
  a rr:TriplesMap ;
  rr:logicalTable [
    rr:tableName "ecommerce.cgoods_in_receipt"
  ];
  rr:subjectMap [
    rr:template "http://data.ecommerce/goods_in_receipt#{receipt_id}_{good_id}";
    rr:class ecommerce:Order_Description;
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:numberof ;
    rr:objectMap [rr:column "numberof"];
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:Order ;
    rr:objectMap [
      rr:parentTriplesMap <#receipt_information> ;
      rr:joinCondition [
        rr:child "receipt_id" ;
       rr:parent "receipt_id"
      ]
    ]
  ].
  
  #rr:predicateObjectMap [
  #  rr:predicate ecommerce:Product ;
  #  rr:objectMap [
  #    rr:parentTriplesMap <#product02> ;
  #    rr:joinCondition [
  #      rr:child "good_id" ;
  #      rr:parent "sku"
  #    ]
  #  ]
  #].

# Has_The_Delivery_Type Mapping
<#Has_The_Delivery_Type>
  rr:logicalTable [
    rr:sqlQuery """SELECT A.receipt_id, B.delivery_kind
                   FROM ecommerce.creceipt_information A
                   FULL JOIN ecommerce.cdelivery_services_type B
                   ON A.delivery_type = B.delivery_kind;""";
    rr:sqlVersion rr:SQL2008;
  ];
  rr:subjectMap[
    rr:template "http://data.ecommerce/Has_The_Delivery_Type#{receipt_id}";
    rr:class ecommerce:Order;
  ];
  rr:predicateObjectMap[
    rr:predicate ecommerce:Has_The_Delivery_Type;
    rr:objectMap[
      rr:template "http://data.ecommerce/Has_The_Delivery_Type#{delivery_kind}";
    ]
  ].

# Has_Order_Description Mapping
<#Has_Order_Description>
  rr:logicalTable [
    rr:sqlQuery """SELECT A.receipt_id, C.name, C.price, B.numberof
                   FROM ecommerce.creceipt_information A
                   FULL JOIN ecommerce.cgoods_in_receipt B
                   ON A.receipt_id = B.receipt_id
                   FULL JOIN ecommerce.cproduct C
                   ON B.good_id = C.sku;""";
    rr:sqlVersion rr:SQL2008;
  ];
  rr:subjectMap[
    rr:template "http://data.ecommerce/Has_Order_Description#{receipt_id}";
    rr:class ecommerce:Order;
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:Has_Order_Description ;
    rr:objectMap [
      rr:template "http://data.ecommerce/Has_Order_Description#{name}_{price}_{numberof}";
    ]
  ].

# Has_Payment_Card Mapping
<#Has_Payment_Card>
  rr:logicalTable [
    rr:sqlQuery """SELECT A.first_name, A.last_name, B.cardType, B.cardnumber, B.cardexpirydate
                   FROM ecommerce.ccustomers_information A
                   FULL JOIN ecommerce.cpaymentcard B
                   ON A.email = B.customeremail""";
    rr:sqlVersion rr:SQL2008;
  ];
  rr:subjectMap[
    rr:template "http://data.ecommerce/Has_Payment_Card#{first_name}_{last_name}";
    rr:class ecommerce:Customer;
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:Has_Payment_Card ;
    rr:objectMap [
      rr:template "http://data.ecommerce/Has_Payment_Card#{cardnumber}_{cardexpirydate}_{cardtype}";
    ]
].

# places_order Mapping
<#places_order>
  rr:logicalTable [
    rr:sqlQuery """SELECT A.first_name, A.last_name, C.receipt_id, C.date, C.orderamount, C.delivery_type, C.delivery_status
                   FROM ecommerce.ccustomers_information A
                   FULL JOIN ecommerce.ccustomer_receipt_connector B
                   ON A.email = B.email
                   FULL JOIN ecommerce.creceipt_information C
                   ON C.receipt_id = B.receipt_id;""";
    rr:sqlVersion rr:SQL2008;
  ];
  rr:subjectMap[
    rr:template "http://data.ecommerce/places_order#{first_name}_{last_name}";
    rr:class ecommerce:Customer;
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:places_order ;
    rr:objectMap [
      rr:template "http://data.ecommerce/places_order#{receipt_id}_{date}_{orderamount}_{delivery_type}_{delivery_status}";
    ]
].

# prefers_delivery_type Mapping
<#prefers_delivery_type>
  rr:logicalTable [
    rr:sqlQuery """SELECT A.first_name, A.last_name, B.delivery_kind
                   FROM ecommerce.ccustomers_information A
                   FULL JOIN ecommerce.cdelivery_services_type B
                   ON A.delivery_kind = B.delivery_kind""";
    rr:sqlVersion rr:SQL2008;
  ];
  rr:subjectMap[
    rr:template "http://data.ecommerce/prefers_delivery_type#{first_name}_{last_name}";
    rr:class ecommerce:Customer;
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:prefers_delivery_type ;
    rr:objectMap [
      rr:template "http://data.ecommerce/prefers_delivery_type#{delivery_kind}";
    ]
].
# Has_Address Mapping
<#Has_Address>
rr:logicalTable [
  rr:sqlQuery """SELECT A.email, A.first_name, A.last_name, B.country, B.city, B.address
                 FROM ecommerce.ccustomers_addresses B
                 FULL JOIN ecommerce.ccustomers_information A
                 ON A.email = B.email;""";
    rr:sqlVersion rr:SQL2008;
  ];
  rr:subjectMap[
    rr:template "http://data.ecommerce/Has_Address#{email}_{first_name}_{last_name}";
    rr:class ecommerce:Customer;
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:Has_Address ;
    rr:objectMap [
      rr:template "http://data.ecommerce/Has_AddressW#{country}_{city}_{address}";
    ]
  ].
  
<#Has_Delivery_Status>
rr:logicalTable [
  rr:sqlQuery """SELECT A.receipt_id, B.delivery_status
                   FROM ecommerce.creceipt_information A
                   FULL JOIN ecommerce.cdelivery_status_description B
                   ON A.delivery_status = B.delivery_status;""";
    rr:sqlVersion rr:SQL2008;
  ];
  rr:subjectMap[
    rr:template "http://data.ecommerce/Has_Delivery_Status#{receipt_id}";
    rr:class ecommerce:Order;
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:Has_Address ;
    rr:objectMap [
      rr:template "http://data.ecommerce/Has_Delivery_Status#{delivery_status}";
    ]
  ].


