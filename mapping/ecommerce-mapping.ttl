@prefix rr: <http://www.w3.org/ns/r2rml#>.
@prefix ecommerce: <http://data.ecommerce#>.

#Supplier Mapping
<#Supplier>
  a rr:TriplesMap ;
  rr:logicalTable [rr:tableName "ecommerce.sv_supplier"];
  rr:subjectMap[
    rr:template "http://data.ecommerce/Supplier#{companyname}";
    rr:class ecommerce:supplier;
  ];
  rr:predicateObjectMap[
    rr:predicate ecommerce:Supplierbce;
    rr:objectMap[
      rr:column "bce"
    ]
  ];
  rr:predicateObjectMap[
    rr:predicate ecommerce:Supplier_companyName;
    rr:objectMap[
      rr:column "companyname"
    ]
  ];
  rr:predicateObjectMap[
    rr:predicate ecommerce:Supplier_postalCode;
    rr:objectMap[
      rr:column "postalcode"
    ]
  ];
  rr:predicateObjectMap[
    rr:predicate ecommerce:Supplier_ph;
    rr:objectMap[
      rr:column "telephone"
    ]
  ];
  rr:predicateObjectMap[
    rr:predicate ecommerce:Supplier_country;
    rr:objectMap[
      rr:column "addresscountry"
    ]
  ];
  rr:predicateObjectMap[
    rr:predicate ecommerce:Supplier_streetAddress;
    rr:objectMap[
      rr:column "streetaddress"
    ]
  ];
  rr:predicateObjectMap[
    rr:predicate ecommerce:supplier_addressLocaity;
    rr:objectMap[
      rr:column "addresslocality"
    ]
  ];
  rr:predicateObjectMap[
    rr:predicate ecommerce:Supplier_city;
    rr:objectMap[
      rr:column "addresscity"
    ]
  ];
  rr:predicateObjectMap[
    rr:predicate ecommerce:Supplier_email;
    rr:objectMap[
      rr:column "email"
    ]
  ].
  <#Supplies>
  a rr:TriplesMap ;
  rr:logicalTable [rr:tableName "ecommerce.sv_supplies"];
  rr:subjectMap[
    rr:template "http://data.ecommerce/Supplies#{suppliesid}";
    rr:class ecommerce:Supplies;
  ];
  rr:predicateObjectMap[
    rr:predicate ecommerce:suppliesID;
    rr:objectMap[
      rr:column "suppliesid"
    ]
  ];
  rr:predicateObjectMap[
    rr:predicate ecommerce:arrivalDate;
    rr:objectMap[
      rr:column "arrivaldate"
    ]
  ];
  rr:predicateObjectMap[
    rr:predicate ecommerce:supplyState;
    rr:objectMap[
      rr:column "supplystate"
    ]
  ].
  <#SuppliesStock>
  a rr:TriplesMap ;
  rr:logicalTable [rr:tableName "ecommerce.sv_suppliesstock"];
  rr:subjectMap[
    rr:template "http://data.ecommerce/SuppliesStock#{supply}";
    rr:class ecommerce:SuppliesStock;
  ];
  rr:predicateObjectMap[
    rr:predicate ecommerce:suppliesStockSku;
    rr:objectMap[
      rr:column "supply"
    ]
  ];
  rr:predicateObjectMap[
    rr:predicate ecommerce:suppliesOrderPrice;
    rr:objectMap[
      rr:column "price"
    ]
  ];
  rr:predicateObjectMap[
    rr:predicate ecommerce:suppliesOrderQuantity;
    rr:objectMap[
      rr:column "quantity"
    ]
  ].
  
  # adding products for supplyStock class 
<#ProductsSupplies>
  a rr:TriplesMap ;
  rr:logicalTable [rr:tableName "ecommerce.sv_product"];
  rr:subjectMap[
    rr:template "http://data.ecommerce/Product#{sku}";
    rr:class ecommerce:Product;
  ];
  rr:predicateObjectMap[
    rr:predicate ecommerce:sku;
    rr:objectMap[
      rr:column "sku"
    ]
  ];
  rr:predicateObjectMap[
    rr:predicate ecommerce:brand;
    rr:objectMap[
      rr:column "brand"
    ]
  ];
  rr:predicateObjectMap[
    rr:predicate ecommerce:category;
    rr:objectMap[
      rr:column "category"
    ]
  ];
  rr:predicateObjectMap[
    rr:predicate ecommerce:color;
    rr:objectMap[
      rr:column "color"
    ]
  ];
  rr:predicateObjectMap[
    rr:predicate ecommerce:Item_condition;
    rr:objectMap[
      rr:column "itemcondition"
    ]
  ];
  rr:predicateObjectMap[
    rr:predicate ecommerce:model;
    rr:objectMap[
      rr:column "model"
    ]
  ];
  rr:predicateObjectMap[
    rr:predicate ecommerce:Product_date_added;
    rr:objectMap[
      rr:column "date_added"
    ]
  ];
  rr:predicateObjectMap[
    rr:predicate ecommerce:Product_description;
    rr:objectMap[
      rr:column "description"
    ]
  ];
  rr:predicateObjectMap[
    rr:predicate ecommerce:price;
    rr:objectMap[
      rr:column "price"
    ]
  ];
  rr:predicateObjectMap[
    rr:predicate ecommerce:stockQuantity;
    rr:objectMap[
      rr:column "stockquantity"
    ]
  ].
  
  # adding warehouse for supplies class 
  <#warehouse>
  a rr:TriplesMap;
  rr:logicalTable [
    rr:tableName "ecommerce.sv_warehouse"
  ];
  rr:subjectMap [
    rr:template "http://data.ecommerce/Warehouse#{warehousecode}";
    rr:class ecommerce:Warehouse;
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:warehousecode;
    rr:objectMap [rr:column "warehousecode"]
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:companyname;
    rr:objectMap [rr:column "companyname"]
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:email;
    rr:objectMap [rr:column "email"]
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:telephone;
    rr:objectMap [rr:column "telephone"]
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:addresscountry;
    rr:objectMap [rr:column "addresscountry"]
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:addresscity;
    rr:objectMap [rr:column "addresscity"]
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:addresslocality;
    rr:objectMap [rr:column "addresslocality"]
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:postalcode;
    rr:objectMap [rr:column "postalcode"]
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:streetaddress;
    rr:objectMap [rr:column "streetaddress"]
  ].
  <#SuppliesProperty>
  a rr:TriplesMap ;
  rr:logicalTable [rr:sqlQuery """SELECT B.csuppliername As csuppliername, A.norderuuid AS norderuuid FROM ecommerce.spurchase_order A
                                  INNER JOIN ecommerce.ssupplier B ON B.csupplierbce=A.csupplierbce""";
                   rr:sqlVersion rr:SQL2008;
  ];
  rr:subjectMap[
    rr:template "http://data.ecommerce/supplier#{csuppliername}";
    rr:class ecommerce:supplier;
  ];
  rr:predicateObjectMap[
    rr:predicate ecommerce:supplies;
    rr:objectMap[
      rr:template "http://data.ecommerce/Supplies#{norderuuid}";
    ]
  ].
  <#Supplies_has>
  a rr:TriplesMap ;  
  rr:logicalTable [rr:sqlQuery """SELECT A.norderuuid, B.norderdetailuuid FROM ecommerce.spurchase_order A
                                  INNER JOIN ecommerce.spurchase_order_detail B ON B.norderuuid=A.norderuuid""";
                                  rr:sqlVersion rr:SQL2008;
  ];
  rr:subjectMap[
    rr:template "http://data.ecommerce/Supplies/{norderuuid}";
    rr:class ecommerce:Supplies;
  ];
  rr:predicateObjectMap[
    rr:predicate ecommerce:supplies_has;
    rr:objectMap[
      rr:template "http://data.ecommerce/SuppliesStock/{norderdetailuuid}";
    ]
  ].
  <#is_delivered_to>
  rr:logicalTable [rr:sqlQuery """SELECT A.norderuuid, B.bce AS warehousecode FROM ecommerce.spurchase_order A
                                  INNER JOIN ecommerce.swarehouse B ON B.bce=A.warehousecode""";
                                  rr:sqlVersion rr:SQL2008;
  ];
  rr:subjectMap[
    rr:template "http://data.ecommerce/Supplies/{norderuuid}";
    rr:class ecommerce:Supplies;
  ];
  rr:predicateObjectMap[
    rr:predicate ecommerce:is_delivered_to;
    rr:objectMap[
      rr:template "http://data.ecommerce/Warehouse/{warehousecode}";
    ]
  ].
  
#Warehouse Mapping
<#Warehouse02>
  a rr:TriplesMap ;
  rr:logicalTable [rr:tableName "ecommerce.wwarehouse"];
  rr:subjectMap[
    rr:template "http://data.ecommerce/Warehouse#{warehousecode}";
    rr:class ecommerce:Warehouse;
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:warehous_code;
    rr:objectMap [rr:column "warehousecode"]
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:Warehouse_companyName;
    rr:objectMap [rr:column "companyname"]
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:Warehouse_email;
    rr:objectMap [rr:column "email"]
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:telephone;
    rr:objectMap [rr:column "telephone"]
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:Warehouse_country;
    rr:objectMap [rr:column "addresscountry"]
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:Warehouse_city;
    rr:objectMap [rr:column "addresscity"]
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:warehouse_addresslocaity;
    rr:objectMap [rr:column "addresslocality"]
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:Warehouse_postalCode;
    rr:objectMap [rr:column "postalcode"]
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:Warehouse_streetAddress;
    rr:objectMap [rr:column "streetAddress"]
  ].
  
#Inventory mapping
<#Inventory>
  a rr:TriplesMap;
  
  rr:logicalTable [rr:sqlQuery """SELECT productsku_fk, warehousecode_fk, quantity FROM ecommerce.winventory""";
                                  rr:sqlVersion rr:SQL2008;
  ];
  rr:subjectMap [
    rr:template "http://data.ecommerce/Inventory#{productsku_fk}_{warehousecode_fk}";
    rr:class ecommerce:Inventory;
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:warehous_code;
    rr:objectMap [rr:column "warehousecode_fk"]
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:InventoryQuantity;
    rr:objectMap [rr:column "quantity"]
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:productsku_fk;
    rr:objectMap [rr:column "productsku_fk"]
  ]. 
   
#warehouse_has mapping
<#warehouse_has>
  a rr:TriplesMap;
  
  rr:logicalTable [
  rr:sqlQuery """SELECT A.warehousecode AS warehousecode,
                  B.warehousecode_fk,
                  B.productsku_fk
                  FROM ecommerce.wwarehouse A INNER JOIN ecommerce.winventory B ON warehousecode=B.warehousecode_fk""";
                  rr:sqlVersion rr:SQL2008;
  ];
  rr:subjectMap [
    rr:template "http://data.ecommerce/Warehouse#{warehousecode}";
    rr:class ecommerce:Warehouse;
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:warehouse_has;
    rr:objectMap [
      rr:template "http://data.ecommerce/Inventory#{productsku_fk}_{warehousecode_fk}";
    ];
  ].

# TransportCompany Mapping
<#transportcompany>
  a rr:TriplesMap ;
  
  rr:logicalTable [
  rr:sqlQuery """SELECT name, price_per_km, api_key
                  FROM ecommerce.dtransportcompany""";
                  rr:sqlVersion rr:SQL2008;
  ];
  rr:subjectMap [
    rr:template "http://data.ecommerce/TransportCompany#{name}";
    rr:class ecommerce:TransportCompany;
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:TransportCompanyname ;
    rr:objectMap [rr:column "name"];
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:price_per_km ;
    rr:objectMap [rr:column "price_per_km"];
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:api_key ;
    rr:objectMap [rr:column "api_key"];
  ].

# deliverytrip Mapping
<#transportvehicle>
  a rr:TriplesMap ;
  rr:logicalTable [
    rr:tableName "ecommerce.dtransportvehicle"
  ];
  rr:subjectMap [
    rr:template "http://data.ecommerce/Transportvehicle#{id}";
    rr:class ecommerce:TransportVehicle;
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:TransportVehicleID ;
    rr:objectMap [rr:column "id"];
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:position ;
    rr:objectMap [rr:column "position"];
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:TransportCompany;
    rr:objectMap [
      rr:parentTriplesMap <#transportcompany> ;
      rr:joinCondition [
        rr:child "company" ;
        rr:parent "name"
      ]
    ]
  ].
  #Warehouse mapping
<#Warehouse03>
  a rr:TriplesMap;
  rr:logicalTable [
    rr:tableName "ecommerce.dwarehouse"
  ];
  rr:subjectMap [
    rr:template "http://data.ecommerce/Warehouse#{warehousecode}";
    rr:class ecommerce:Warehouse;
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:warehous_code;
    rr:objectMap [rr:column "warehousecode"]
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:Warehouse_companyName;
    rr:objectMap [rr:column "companyname"]
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:Warehouse_email;
    rr:objectMap [rr:column "email"]
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:telephone;
    rr:objectMap [rr:column "telephone"]
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:Warehouse_country;
    rr:objectMap [rr:column "addresscountry"]
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:Warehouse_city;
    rr:objectMap [rr:column "addresscity"]
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:warehouse_addresslocaity;
    rr:objectMap [rr:column "addresslocality"]
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:Warehouse_postalCode;
    rr:objectMap [rr:column "postalcode"]
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:Warehouse_streetAddress;
    rr:objectMap [rr:column "streetaddress"]
  ].
  
  # deliverytrip Mapping
<#deliverytrip>
  a rr:TriplesMap ;
  rr:logicalTable [
    rr:tableName "ecommerce.ddeliverytrip"
  ];
  rr:subjectMap [
    rr:template "http://data.ecommerce/Deliverytrip#{id}";
    rr:class ecommerce:DeliveryTrip;
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:DeliveryTrip_ID ;
    rr:objectMap [rr:column "id"];
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:departure_time ;
    rr:objectMap [rr:column "departure_time"];
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:arrival_time ;
    rr:objectMap [rr:column "arrival_time"];
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:TransportVehicle ;
    rr:objectMap [
      rr:parentTriplesMap <#transportvehicle> ;
      rr:joinCondition [
        rr:child "truck";
        rr:parent "id"
      ]
    ]
  ];
  rr:predicateObjectMap [
    rr:predicate ecommerce:Warehouse ;
    rr:objectMap [
      rr:parentTriplesMap <#Warehouse03>;
      rr:joinCondition [
        rr:child "starting_warehouse";
        rr:parent "warehousecode"
      ]
    ]
  ].


  

